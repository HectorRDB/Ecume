<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weighted KS Test — ks_test • Ecume</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Weighted KS Test — ks_test" />
<meta property="og:description" content="Weighted Kolmogorov-Smirnov Two-Sample Test with threshold" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ecume</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Ecume.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HectorRDB/Ecume">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weighted KS Test</h1>
    
    <div class="hidden name"><code>ks_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Weighted Kolmogorov-Smirnov Two-Sample Test with threshold</p>
    </div>

    <pre class="usage"><span class='fu'>ks_test</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, thresh <span class='op'>=</span> <span class='fl'>0.05</span>, w_x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>, w_y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Vector of values sampled from the first distribution</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector of values sampled from the second distribution</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>The threshold needed to clear between the two cumulative distributions</p></td>
    </tr>
    <tr>
      <th>w_x</th>
      <td><p>The observation weights for x</p></td>
    </tr>
    <tr>
      <th>w_y</th>
      <td><p>The observation weights for y</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with class <code>"htest"</code> containing the following components:</p><ul>
<li><p><em>statistic</em> the value of the test statistic.</p></li>
<li><p><em>p.value</em> the p-value of the test.</p></li>
<li><p><em>alternative</em> a character string describing the alternative hypothesis.</p></li>
<li><p><em>method</em> a character string indicating what type of test was performed.</p></li>
<li><p><em>data.name</em> a character string giving the name(s) of the data.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The usual Kolmogorov-Smirnov test for two vectors <strong>X</strong> and <strong>Y</strong>, of size m
and n rely on the empirical cdfs \(E_x\) and \(E_y\) and the test statistic
$$D = sup_{t\in (X, Y)} |E_x(x) - E_y(x))$$.
This modified Kolmogorov-Smirnov test relies on two modifications.</p><ul>
<li><p>Using observation weights for both vectors <strong>X</strong> and <strong>Y</strong>: Those
weights are used in two places, while modifying the usual KS test. First, the
empirical cdfs are updates to account for the weights. Secondly, the effective
sample sizes are also modified. This is inspired from
<a href='https://stackoverflow.com/a/55664242/13768995'>https://stackoverflow.com/a/55664242/13768995</a>, using Monahan (2011).</p></li>
<li><p>Testing against a threshold: the test statistic is thresholded such
that \(D = max(D - thresh, 0)\). Since \(0\le D\le 1\), the value of
the threshold is also between 0 and 1, representing an effect size for the
difference.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Monahan, J. (2011). <em>Numerical Methods of Statistics</em> (2nd ed.,
Cambridge Series in Statistical and Probabilistic Mathematics). Cambridge:
Cambridge University Press. doi:10.1017/CBO9780511977176</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
 <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span>, min <span class='op'>=</span> <span class='fl'>.5</span>, max <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span>
 <span class='fu'>ks_test</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, thresh <span class='op'>=</span> <span class='fl'>.001</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Two-sample Weighted Kolmogorov-Smirnov test with threshold 0.001
#&gt; 
#&gt; data:  x and y
#&gt; = 0.569, p-value = 1.743e-14
#&gt; alternative hypothesis: two-sided
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Hector Roux de Bezieux.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


