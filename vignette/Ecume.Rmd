---
title: "Ecume"
author: "Hector Roux de BÃ©zieux"
bibliography: Ecume.bib
date: '`r format(Sys.time(), "%d %B , %Y")`'
output: 
  rmarkdown::html_document:
    toc: true
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{Using DifTopo}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r packages, include=F}
library(knitr)
opts_chunk$set(
  fig.pos = "!h", out.extra = "", warning = FALSE, message = FALSE, 
  fig.align = "center", echo = FALSE
)
```

# Aim of the package

The _Ecume_ package provides statistical methods to test whether samples are from the same or distinct distributions. It contains non-parametric tests for different settings. 

# Two sample tests for univariate distribution
## General Setting

Consider two distributions $P_1$ and $P_2$. We want to test the null hypothesis $H_0: P_1 = P_2$. To do this, we have two sets of observations $x_i\sim P_1$, with $i\in[1,\ldots m]$ and $y_j\sim P_1$, with $j\in[1,\ldots n]$. 

## Kolmogorov-Smirnov test

The Kolmogorov-Smirnov statistic for two samples relies on the empirical cumulative distributions $F_x$ and $F_y$ for **univariate** distributions and is computed as

$$D_{n,m}=\sup _{x\in\{x_i, y_j\},i\in[1,\ldots m], j\in[1,\ldots n]}|F_x(x)-F_y(x)|$$

We can compute the distribution of $D_{n,m}$ under the null and device a test. If the distributions are identical we expect to not reject the null about 95% of the time, for a nominal level of $.05$.

```{r}
set.seed(20)
x <- rnorm(100, 0, 1)
y <- rnorm(200, 0, 1)
ks.test(x, y)
```

However, if the distributions are not identical, we see that we would reject the null hypothesis.

```{r}
set.seed(20)
x <- rnorm(100, 0, 1)
y <- rnorm(200, 0, 2)
ks.test(x, y)
```

## Adding observation weights and threshold

Now, let us imagine we also have observations weights $w_{x, i}$ and $w_{y, j}$ for all samples. Moreover, instead of testing $H_0:D_{m,n} =0$, we want to test against an effect size, i.e. $H_0:D_{m,n} \leq c$. Relying on [@Monahan2011], we can do this using the `ks_test` function:

```{r}
library(Ecume)
set.seed(20)
x <- rnorm(100, 0, 1)
w_x <- runif(100, 0, 1)
y <- rnorm(200, 0, 1)
w_y <- runif(200, 0, 1)
ks_test(x = x, y = y, w_x = w_x, w_y = w_y, thresh = .01)
```


```{r}
set.seed(20)
x <- rnorm(100, 0, 1)
w_x <- runif(100, 0, 1)
y <- rnorm(200, 0, 2)
w_y <- runif(200, 0, 1)
ks_test(x = x, y = y, w_x = w_x, w_y = w_y, thresh = .01)
```

# Mutivariate Distributions

However, the KS test does not work with multivariate distributions. Other statistics have been proposed. Here, we have implemented two

## The two-sample kernel test from [@Gretton2012]



# References
